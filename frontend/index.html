<!DOCTYPE html>
<html lang="en" id="htmlRoot">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title id="pageTitle">Smart Exam System</title>
<link rel="icon" type="image/x-icon" id="faviconLink" href="/favicon.ico">
<script src="https://cdn.tailwindcss.com/3.4.16"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" rel="stylesheet">
<script>
tailwind.config = {
theme: {
extend: {
colors: {
primary: '#6366f1',
secondary: '#8b5cf6',
accent: '#06b6d4',
dark: '#0f172a',
light: '#f8fafc'
},
fontFamily: {
'sans': ['Inter', 'system-ui', 'sans-serif']
},
borderRadius: {
'button': '12px',
'card': '16px'
},
animation: {
'float': 'float 6s ease-in-out infinite',
'pulse-soft': 'pulse-soft 4s ease-in-out infinite',
'gradient': 'gradient 15s ease infinite',
'slide-up': 'slideUp 0.8s ease-out',
'fade-in': 'fadeIn 1s ease-out'
},
keyframes: {
float: {
'0%, 100%': { transform: 'translateY(0px)' },
'50%': { transform: 'translateY(-20px)' }
},
'pulse-soft': {
'0%, 100%': { opacity: '1' },
'50%': { opacity: '0.5' }
},
gradient: {
'0%, 100%': { 'background-position': '0% 50%' },
'50%': { 'background-position': '100% 50%' }
},
slideUp: {
'0%': { transform: 'translateY(100px)', opacity: '0' },
'100%': { transform: 'translateY(0px)', opacity: '1' }
},
fadeIn: {
'0%': { opacity: '0' },
'100%': { opacity: '1' }
}
},
backgroundSize: {
'400%': '400% 400%'
}
}
}
}
</script>
<style>
body {
font-family: 'Inter', sans-serif;
}
.hero-bg {
background: linear-gradient(-45deg, #6366f1, #8b5cf6, #06b6d4, #3b82f6);
background-size: 400% 400%;
animation: gradient 15s ease infinite;
}
.glass-effect {
background: rgba(255, 255, 255, 0.1);
backdrop-filter: blur(10px);
border: 1px solid rgba(255, 255, 255, 0.2);
}
.card-hover {
transition: all 0.3s ease;
}
.card-hover:hover {
transform: translateY(-8px);
box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
}
.loading {
opacity: 0;
transition: opacity 0.3s ease;
}
.loaded {
opacity: 1;
}
.floating-shapes {
position: absolute;
width: 100%;
height: 100%;
overflow: hidden;
}
.floating-shape {
position: absolute;
background: rgba(255, 255, 255, 0.1);
border-radius: 50%;
animation: float 6s ease-in-out infinite;
}
.floating-shape:nth-child(1) {
width: 80px;
height: 80px;
top: 20%;
left: 10%;
animation-delay: 0s;
}
.floating-shape:nth-child(2) {
width: 120px;
height: 120px;
top: 60%;
right: 10%;
animation-delay: 2s;
}
.floating-shape:nth-child(3) {
width: 60px;
height: 60px;
top: 80%;
left: 20%;
animation-delay: 4s;
}
.glow-effect {
box-shadow: 0 0 20px rgba(99, 102, 241, 0.3);
}
</style>
</head>
<body class="bg-gray-50 loading">

<!-- Navigation -->
<nav class="bg-white/90 backdrop-blur-lg shadow-lg border-b border-gray-200/50 fixed w-full top-0 z-50">
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
<div class="flex justify-between items-center h-20">
<div class="flex items-center space-x-4">
<div class="relative">
<img id="systemLogo" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiByeD0iOCIgZmlsbD0iIzYzNjZmMSIvPgo8cGF0aCBkPSJNMTIgMTJIMjhWMTZIMTJWMTJaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMTIgMThIMjRWMjJIMTJWMThaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMTIgMjRIMjhWMjhIMTJWMjRaIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIzMCIgY3k9IjEwIiByPSIzIiBmaWxsPSIjMDZiNmQ0Ii8+Cjwvc3ZnPgo=" alt="System Logo" class="h-12 object-contain transition-transform hover:scale-110 duration-300">
<div class="absolute -inset-2 bg-gradient-to-r from-primary to-secondary rounded-full opacity-20 blur-md"></div>
</div>
<div>
<div id="systemName" class="font-bold text-2xl bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">Smart Exam System</div>
<div class="text-xs text-gray-500 font-medium">AI-Powered Assessment Platform</div>
</div>
</div>
<div class="flex items-center space-x-6">
<button id="languageToggle" class="glass-effect text-gray-700 hover:text-primary transition-all duration-300 px-4 py-2 rounded-button border border-gray-200/50 hover:border-primary/30 hover:glow-effect">
<i class="ri-global-line mr-2"></i>
<span id="currentLanguage" class="font-medium">EN</span>
</button>
<a href="/admin/login" id="adminLoginLink" class="bg-gradient-to-r from-primary to-secondary text-white px-6 py-3 rounded-button hover:shadow-xl transition-all duration-300 font-semibold hover:scale-105 glow-effect">
<i class="ri-user-settings-line mr-2"></i>
<span data-i18n="nav.admin_login">Admin Login</span>
</a>
<div id="adminStatus" class="hidden">
<div class="flex items-center space-x-4">
<div class="flex items-center space-x-2 bg-green-50 px-3 py-2 rounded-button border border-green-200">
<div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
<span class="text-green-700 font-medium text-sm" data-i18n="nav.admin_logged_in">Admin Logged In</span>
</div>
<div class="flex space-x-3">
<a href="/admin/dashboard" class="flex items-center text-primary hover:text-secondary transition-colors text-sm font-medium">
<i class="ri-dashboard-line mr-1"></i><span data-i18n="nav.dashboard">Dashboard</span>
</a>
<button id="adminLogout" class="flex items-center text-red-600 hover:text-red-700 transition-colors text-sm font-medium">
<i class="ri-logout-box-line mr-1"></i><span data-i18n="nav.logout">Logout</span>
</button>
</div>
</div>
</div>
</div>
</div>
</div>
</nav>

<!-- Hero Section -->
<section class="hero-bg relative overflow-hidden min-h-screen flex items-center pt-20">
<!-- Floating Background Shapes -->
<div class="floating-shapes">
<div class="floating-shape"></div>
<div class="floating-shape"></div>
<div class="floating-shape"></div>
</div>

<!-- Main Hero Content -->
<div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24 w-full">
<div class="text-center text-white animate-fade-in">
<!-- Hero Badge -->
<div class="inline-flex items-center px-4 py-2 rounded-full glass-effect mb-8">
<div class="w-2 h-2 bg-accent rounded-full mr-2 animate-pulse"></div>
<span class="text-sm font-medium">Next-Generation Assessment Technology</span>
</div>

<!-- Main Title -->
<h1 id="heroTitle" class="text-6xl lg:text-7xl font-black mb-6 leading-tight" data-i18n="hero.title">
<span class="bg-gradient-to-r from-white via-white to-gray-300 bg-clip-text text-transparent">
Smart Exam System
</span>
</h1>

<!-- Subtitle -->
<p id="heroSubtitle" class="text-xl lg:text-2xl mb-12 opacity-90 max-w-4xl mx-auto leading-relaxed" data-i18n="hero.subtitle">
AI-Powered Intelligent Assessment Platform developed by The Chinese University of Hong Kong, Shenzhen (区块链与智能科技研究中心)
</p>

<!-- Action Buttons -->
<div class="flex flex-col sm:flex-row justify-center items-center gap-6 mb-16">
<a href="/verification" class="group">
<button class="bg-white text-primary px-10 py-4 rounded-button font-bold text-lg hover:shadow-2xl transition-all duration-300 hover:scale-105 glow-effect flex items-center">
<i class="ri-play-circle-line mr-3 text-xl group-hover:animate-pulse"></i>
<span data-i18n="hero.start_exam">Start Exam</span>
<i class="ri-arrow-right-line ml-3 transition-transform group-hover:translate-x-1"></i>
</button>
</a>
<button onclick="handleAdminPanelClick()" class="glass-effect border-2 border-white/30 text-white px-10 py-4 rounded-button font-bold text-lg hover:bg-white/10 transition-all duration-300 hover:scale-105 flex items-center">
<i class="ri-settings-3-line mr-3 text-xl"></i>
<span data-i18n="hero.admin_panel">Admin Panel</span>
</button>
</div>

<!-- Stats Section -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto">
<div class="glass-effect p-6 rounded-card text-center card-hover">
<div class="text-3xl font-bold mb-2">99.9%</div>
<div class="text-sm opacity-80">Security Rate</div>
</div>
<div class="glass-effect p-6 rounded-card text-center card-hover">
<div class="text-3xl font-bold mb-2">AI</div>
<div class="text-sm opacity-80">Smart Grading</div>
</div>
<div class="glass-effect p-6 rounded-card text-center card-hover">
<div class="text-3xl font-bold mb-2">24/7</div>
<div class="text-sm opacity-80">Available</div>
</div>
</div>
</div>

<!-- Scroll Indicator -->
<div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 text-white opacity-60 animate-bounce">
<i class="ri-arrow-down-line text-2xl"></i>
</div>
</div>
</section>

<!-- Features Section -->
<section class="py-24 bg-gradient-to-br from-gray-50 via-white to-gray-50 relative">
<!-- Background Pattern -->
<div class="absolute inset-0 opacity-5">
<div class="absolute inset-0" style="background-image: radial-gradient(circle at 1px 1px, rgba(99,102,241,0.3) 1px, transparent 0); background-size: 50px 50px;"></div>
</div>

<div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
<!-- Section Header -->
<div class="text-center mb-20 animate-slide-up">
<div class="inline-flex items-center px-4 py-2 rounded-full bg-primary/10 border border-primary/20 mb-6">
<i class="ri-sparkling-line text-primary mr-2"></i>
<span class="text-primary font-medium text-sm">Advanced Features</span>
</div>
<h2 class="text-4xl lg:text-5xl font-bold text-gray-900 mb-6" data-i18n="features.title">
<span class="bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">System Features</span>
</h2>
<p class="text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed" data-i18n="features.subtitle">
Advanced examination platform with intelligent assessment and cutting-edge security
</p>
</div>

<!-- Features Grid -->
<div class="grid lg:grid-cols-3 gap-8 lg:gap-12">
<!-- Feature 1: Security -->
<div class="group relative">
<div class="bg-white p-8 rounded-card shadow-lg hover:shadow-2xl transition-all duration-500 card-hover border border-gray-100 relative overflow-hidden">
<!-- Gradient Background -->
<div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-primary/10 to-transparent rounded-full -mr-16 -mt-16"></div>

<!-- Icon -->
<div class="relative w-20 h-20 bg-gradient-to-r from-primary to-secondary rounded-2xl flex items-center justify-center mb-6 glow-effect">
<i class="ri-shield-check-line text-white text-3xl"></i>
</div>

<!-- Content -->
<h3 class="text-2xl font-bold mb-4 text-gray-900" data-i18n="features.security.title">Secure Authentication</h3>
<p class="text-gray-600 leading-relaxed mb-6" data-i18n="features.security.description">
Advanced identity verification and device binding to ensure exam integrity and prevent cheating.
</p>

<!-- Feature List -->
<ul class="space-y-2">
<li class="flex items-center text-sm text-gray-500">
<i class="ri-check-line text-primary mr-2"></i>
<span>Multi-factor Authentication</span>
</li>
<li class="flex items-center text-sm text-gray-500">
<i class="ri-check-line text-primary mr-2"></i>
<span>Device Binding</span>
</li>
<li class="flex items-center text-sm text-gray-500">
<i class="ri-check-line text-primary mr-2"></i>
<span>Real-time Monitoring</span>
</li>
</ul>
</div>
</div>

<!-- Feature 2: AI Assessment -->
<div class="group relative">
<div class="bg-white p-8 rounded-card shadow-lg hover:shadow-2xl transition-all duration-500 card-hover border border-gray-100 relative overflow-hidden">
<!-- Gradient Background -->
<div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-secondary/10 to-transparent rounded-full -mr-16 -mt-16"></div>

<!-- Icon -->
<div class="relative w-20 h-20 bg-gradient-to-r from-secondary to-accent rounded-2xl flex items-center justify-center mb-6 glow-effect">
<i class="ri-brain-line text-white text-3xl"></i>
</div>

<!-- Content -->
<h3 class="text-2xl font-bold mb-4 text-gray-900" data-i18n="features.ai.title">AI-Powered Assessment</h3>
<p class="text-gray-600 leading-relaxed mb-6" data-i18n="features.ai.description">
Intelligent question generation and automated scoring with advanced algorithms and semantic analysis.
</p>

<!-- Feature List -->
<ul class="space-y-2">
<li class="flex items-center text-sm text-gray-500">
<i class="ri-check-line text-secondary mr-2"></i>
<span>Smart Question Generation</span>
</li>
<li class="flex items-center text-sm text-gray-500">
<i class="ri-check-line text-secondary mr-2"></i>
<span>Semantic Scoring</span>
</li>
<li class="flex items-center text-sm text-gray-500">
<i class="ri-check-line text-secondary mr-2"></i>
<span>Adaptive Difficulty</span>
</li>
</ul>
</div>
</div>

<!-- Feature 3: Analytics -->
<div class="group relative">
<div class="bg-white p-8 rounded-card shadow-lg hover:shadow-2xl transition-all duration-500 card-hover border border-gray-100 relative overflow-hidden">
<!-- Gradient Background -->
<div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-accent/10 to-transparent rounded-full -mr-16 -mt-16"></div>

<!-- Icon -->
<div class="relative w-20 h-20 bg-gradient-to-r from-accent to-primary rounded-2xl flex items-center justify-center mb-6 glow-effect">
<i class="ri-dashboard-line text-white text-3xl"></i>
</div>

<!-- Content -->
<h3 class="text-2xl font-bold mb-4 text-gray-900" data-i18n="features.analytics.title">Real-time Analytics</h3>
<p class="text-gray-600 leading-relaxed mb-6" data-i18n="features.analytics.description">
Instant scoring and detailed performance analysis for comprehensive insights and data-driven decisions.
</p>

<!-- Feature List -->
<ul class="space-y-2">
<li class="flex items-center text-sm text-gray-500">
<i class="ri-check-line text-accent mr-2"></i>
<span>Live Dashboard</span>
</li>
<li class="flex items-center text-sm text-gray-500">
<i class="ri-check-line text-accent mr-2"></i>
<span>Performance Metrics</span>
</li>
<li class="flex items-center text-sm text-gray-500">
<i class="ri-check-line text-accent mr-2"></i>
<span>Export Reports</span>
</li>
</ul>
</div>
</div>
</div>

<!-- Additional Features Row -->
<div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mt-16">
<div class="text-center p-6 rounded-card bg-white/50 backdrop-blur-sm border border-gray-200/50">
<div class="w-12 h-12 bg-gradient-to-r from-primary to-secondary rounded-xl flex items-center justify-center mx-auto mb-4">
<i class="ri-global-line text-white text-xl"></i>
</div>
<h4 class="font-semibold text-gray-900 mb-2">Multi-Language</h4>
<p class="text-sm text-gray-600">Support for multiple languages</p>
</div>
<div class="text-center p-6 rounded-card bg-white/50 backdrop-blur-sm border border-gray-200/50">
<div class="w-12 h-12 bg-gradient-to-r from-secondary to-accent rounded-xl flex items-center justify-center mx-auto mb-4">
<i class="ri-cloud-line text-white text-xl"></i>
</div>
<h4 class="font-semibold text-gray-900 mb-2">Cloud-Based</h4>
<p class="text-sm text-gray-600">Scalable cloud infrastructure</p>
</div>
<div class="text-center p-6 rounded-card bg-white/50 backdrop-blur-sm border border-gray-200/50">
<div class="w-12 h-12 bg-gradient-to-r from-accent to-primary rounded-xl flex items-center justify-center mx-auto mb-4">
<i class="ri-smartphone-line text-white text-xl"></i>
</div>
<h4 class="font-semibold text-gray-900 mb-2">Mobile Ready</h4>
<p class="text-sm text-gray-600">Responsive design for all devices</p>
</div>
<div class="text-center p-6 rounded-card bg-white/50 backdrop-blur-sm border border-gray-200/50">
<div class="w-12 h-12 bg-gradient-to-r from-primary to-accent rounded-xl flex items-center justify-center mx-auto mb-4">
<i class="ri-time-line text-white text-xl"></i>
</div>
<h4 class="font-semibold text-gray-900 mb-2">24/7 Available</h4>
<p class="text-sm text-gray-600">Always available for assessments</p>
</div>
</div>
</div>
</section>

<!-- Footer -->
<footer class="bg-gradient-to-r from-dark via-gray-900 to-dark text-white relative overflow-hidden">
<!-- Background Pattern -->
<div class="absolute inset-0 opacity-5">
<div class="absolute inset-0" style="background-image: radial-gradient(circle at 2px 2px, rgba(255,255,255,0.15) 1px, transparent 0); background-size: 50px 50px;"></div>
</div>

<div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">

<!-- Bottom Bar -->
<div class="space-y-6">
<!-- Brand Section -->
<div class="flex justify-center items-center space-x-3">
<div class="relative">
<img id="footerLogo" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiByeD0iOCIgZmlsbD0iIzYzNjZmMSIvPgo8cGF0aCBkPSJNMTIgMTJIMjhWMTZIMTJWMTJaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMTIgMThIMjRWMjJIMTJWMThaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNMTIgMjRIMjhWMjhIMTJWMjRaIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIzMCIgY3k9IjEwIiByPSIzIiBmaWxsPSIjMDZiNmQ0Ci8+Cjwvc3ZnPgo=" alt="System Logo" class="object-contain h-8 w-auto">
<div class="absolute -inset-1 bg-gradient-to-r from-primary to-secondary rounded-full opacity-15 blur-sm"></div>
</div>
<div class="text-center">
<div id="footerSystemName" class="font-bold text-lg bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent" data-i18n="footer.system_name">Smart Exam System</div>
<p class="text-gray-500 text-xs leading-tight mt-1">
AI-Powered Assessment Platform by CUHK-Shenzhen (区块链与智能科技研究中心)
</p>
</div>
</div>

<!-- Footer Info -->
<div class="border-t border-gray-800 pt-6">
<div class="flex flex-col md:flex-row justify-between items-center space-y-3 md:space-y-0">
<div id="footerCopyright" class="text-gray-400 text-sm text-center md:text-left" data-i18n="footer.copyright">
© 2025 <a href="https://cbit.cuhk.edu.cn" target="_blank" rel="noopener noreferrer" class="text-primary hover:text-secondary transition-colors font-medium">CBIT</a> 智能考试系统. 保留所有权利
</div>
<div class="flex items-center space-x-4">
<div class="flex items-center space-x-2 text-sm text-gray-400">
<div class="w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"></div>
<span class="text-xs">System Online</span>
</div>
<a href="https://github.com/reneverland/CBIT-AiExam-plus" target="_blank" rel="noopener noreferrer" class="hover:opacity-80 transition-opacity">
<img src="https://img.shields.io/badge/GitHub-reneverland%2FCBIT--AiExam--plus-blue?logo=github&logoColor=white&style=for-the-badge" alt="GitHub Repository" class="h-6">
</a>
</div>
</div>
</div>
</div>
</div>
</footer>

<!-- Translations -->
<script id="translations">
// 全局翻译对象，从服务器加载
let translations = {};
</script>

<script id="system-config">
// System configuration management
let systemConfig = {
language: 'en',
systemName: 'Smart Exam System',
logo: null,
favicon: '/favicon.ico',
footerText: '© 2025 <a href="https://cbit.cuhk.edu.cn" target="_blank" rel="noopener noreferrer" class="text-blue-400 hover:text-blue-300 transition-colors">CBIT</a> 智能考试系统. 保留所有权利'
};

// Load translations
async function loadTranslations() {
try {
const response = await fetch('/api/translations');
if (response.ok) {
const result = await response.json();
if (result.success) {
translations = result.translations;
}
}
} catch (error) {
console.log('使用默认翻译配置');
}
}

// Load system configuration
async function loadSystemConfig() {
try {
const response = await fetch('/api/system-config');
if (response.ok) {
const config = await response.json();
if (config.success) {
systemConfig = { ...systemConfig, ...config.data };
applySystemConfig();
}
}
} catch (error) {
console.log('使用默认系统配置');
}
}

// Apply system configuration
function applySystemConfig() {
// Apply language
if (systemConfig.language) {
setLanguage(systemConfig.language);
}

// Apply language control
const languageToggle = document.getElementById('languageToggle');
if (systemConfig.enforceLanguage === true || systemConfig.enforceLanguage === 'true') {
// 隐藏语言切换按钮
languageToggle.style.display = 'none';
} else {
// 显示语言切换按钮
languageToggle.style.display = 'flex';
}

// Apply system name
if (systemConfig.systemName) {
document.getElementById('systemName').textContent = systemConfig.systemName;
document.getElementById('footerSystemName').textContent = systemConfig.systemName;
document.getElementById('pageTitle').textContent = systemConfig.systemName;
}

// Apply logo (移除尺寸限制)
if (systemConfig.logo) {
const systemLogo = document.getElementById('systemLogo');
const footerLogo = document.getElementById('footerLogo');
systemLogo.src = systemConfig.logo;
footerLogo.src = systemConfig.logo;
// 移除固定尺寸，允许自适应
systemLogo.className = 'h-10 object-contain';
}

// Apply favicon
if (systemConfig.favicon) {
document.getElementById('faviconLink').href = systemConfig.favicon;
}

// Apply footer text - 现在由翻译系统处理
// if (systemConfig.footerText) {
//     document.getElementById('footerCopyright').innerHTML = systemConfig.footerText;
// }
}

// Language management
let currentLanguage = 'en';

function setLanguage(lang) {
currentLanguage = lang;
document.getElementById('htmlRoot').lang = lang;
document.getElementById('currentLanguage').textContent = lang.toUpperCase();

const elements = document.querySelectorAll('[data-i18n]');
elements.forEach(element => {
const key = element.getAttribute('data-i18n');
if (translations[lang] && translations[lang][key]) {
// 对于包含HTML的翻译内容，使用innerHTML
if (key === 'footer.copyright') {
element.innerHTML = translations[lang][key];
} else {
element.textContent = translations[lang][key];
}
}
});

// Update title
if (translations[lang] && translations[lang]['hero.title']) {
document.getElementById('pageTitle').textContent = translations[lang]['hero.title'];
}

localStorage.setItem('language', lang);
}

function toggleLanguage() {
// 检查是否强制统一语言
if (systemConfig.enforceLanguage === true || systemConfig.enforceLanguage === 'true') {
return; // 如果强制统一语言，不允许切换
}
const newLang = currentLanguage === 'en' ? 'zh' : 'en';
setLanguage(newLang);
}

// Admin Panel 点击处理
async function handleAdminPanelClick() {
try {
const response = await fetch('/api/admin/status');
const result = await response.json();

if (result.success && result.is_admin) {
// 已登录，跳转到管理后台
window.location.href = '/admin/dashboard';
} else {
// 未登录，跳转到登录页面
window.location.href = '/admin/login';
}
} catch (error) {
console.error('检查管理员状态失败:', error);
// 发生错误时，默认跳转到登录页面
window.location.href = '/admin/login';
}
}

// Admin status management
async function checkAdminStatus() {
try {
const response = await fetch('/api/admin/status');
const result = await response.json();
if (result.success && result.is_admin) {
document.getElementById('adminLoginLink').classList.add('hidden');
document.getElementById('adminStatus').classList.remove('hidden');
}
} catch (error) {
console.log('检查管理员状态失败:', error);
}
}

// Admin logout
async function adminLogout() {
try {
const response = await fetch('/api/admin/logout', {
method: 'POST',
headers: {
'Content-Type': 'application/json',
}
});
const result = await response.json();
if (result.success) {
location.reload();
}
} catch (error) {
console.error('登出失败:', error);
}
}

// Smooth scrolling for anchor links
function smoothScrollTo(target) {
const element = document.querySelector(target);
if (element) {
element.scrollIntoView({
behavior: 'smooth',
block: 'start'
});
}
}

// Intersection Observer for animations
function initScrollAnimations() {
const observerOptions = {
threshold: 0.1,
rootMargin: '0px 0px -50px 0px'
};

const observer = new IntersectionObserver((entries) => {
entries.forEach(entry => {
if (entry.isIntersecting) {
entry.target.classList.add('animate-slide-up');
observer.unobserve(entry.target);
}
});
}, observerOptions);

// Observe elements with animation classes
document.querySelectorAll('.card-hover, .glass-effect').forEach(el => {
observer.observe(el);
});
}

// Navbar scroll effect
function initNavbarEffects() {
const navbar = document.querySelector('nav');
let lastScrollY = window.scrollY;

window.addEventListener('scroll', () => {
const currentScrollY = window.scrollY;

if (currentScrollY > 100) {
navbar.classList.add('bg-white/95');
navbar.classList.remove('bg-white/90');
} else {
navbar.classList.remove('bg-white/95');
navbar.classList.add('bg-white/90');
}

// Hide/show navbar on scroll
if (currentScrollY > lastScrollY && currentScrollY > 200) {
navbar.style.transform = 'translateY(-100%)';
} else {
navbar.style.transform = 'translateY(0)';
}
lastScrollY = currentScrollY;
}, { passive: true });
}

// Initialize page
document.addEventListener('DOMContentLoaded', async function() {
// Load translations first
await loadTranslations();

// Load system configuration
await loadSystemConfig();

// Check admin status
await checkAdminStatus();

// Load saved language preference
const savedLanguage = localStorage.getItem('language') || systemConfig.language || 'en';
if (savedLanguage !== currentLanguage) {
setLanguage(savedLanguage);
}

// Event listeners
document.getElementById('languageToggle').addEventListener('click', toggleLanguage);
document.getElementById('adminLogout').addEventListener('click', adminLogout);

// Initialize enhanced features
initScrollAnimations();
initNavbarEffects();

// Add smooth scrolling to anchor links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
anchor.addEventListener('click', function (e) {
e.preventDefault();
const target = this.getAttribute('href');
smoothScrollTo(target);
});
});

// Show page with fade-in effect
document.body.classList.add('loaded');

// Add parallax effect to hero section
const hero = document.querySelector('.hero-bg');
if (hero) {
window.addEventListener('scroll', () => {
const scrolled = window.pageYOffset;
hero.style.transform = `translateY(${scrolled * 0.5}px)`;
}, { passive: true });
}
});
</script>

</body>
</html>